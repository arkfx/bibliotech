<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finalizar Pedido - BiblioTech</title>
    <link rel="icon" href="../public/images/favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="../public/css/main.css" />
    <link rel="stylesheet" href="../public/css/page/finalizacao.css" />
  </head>
  <body>
    <header class="header">
      <a href="home.html" class="logo heading-primary">BiblioTech</a>

      <div class="mobile-nav-toggle">
        <span class="hamburger">&#9776;</span>
      </div>

      <nav class="main-nav">
        <ul class="main-nav-list">
          <!-- Select para filtrar por g√™neros -->
          <li>
            <select id="filter-genres" class="filter-genres">
              <option value="">Todos os G√™neros</option>
            </select>
          </li>

          <li><input type="text" placeholder="Pesquisar Livro..." /></li>
          <li><button class="btn">Buscar</button></li>
          <li>
            <a href="generos.html" class="main-nav-link navegacao">G√™neros</a>
          </li>

          <li>
            <a href="carrinho.html" id="icart" class="main-nav-link cart-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path
                  d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
                ></path>
              </svg>
            </a>
          </li>

          <!-- Bot√µes vis√≠veis apenas se o admin estiver logado -->
          <li id="btnPainelAdmin" style="display: none">
            <a href="admin.html" class="main-nav-link">Painel Admin.</a>
          </li>

          <div class="dropdown">
            <button class="dropdown-toggle profile-button" id="btnPerfil">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="icon-profile"
              >
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            </button>
            <div class="dropdown-menu">
              <a href="perfil.html" class="dropdown-item" id="btnPerfil"
                >Meu Perfil</a
              >
              <a href="biblioteca.html" class="dropdown-item" id="btnBiblioteca"
                >Biblioteca</a
              >
              <a href="#" class="dropdown-item" id="btnLogout">Logout</a>
            </div>
          </div>

          <!-- Bot√µes vis√≠veis quando o admin N√ÉO estiver logado -->
          <li id="btnLogin">
            <a href="login.html" class="main-nav-link nav-cta login">Login</a>
          </li>
          <li id="btnCadastro">
            <a
              href="cadastro-usuario.html"
              class="main-nav-link nav-cta cadastro"
              >Cadastro</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <main class="main-content checkout-page">
      <h1 class="checkout-title">Finalizar Pedido</h1>
      <div class="checkout-container">
        <section class="checkout-form">
          <!-- Notifica√ß√£o para apenas ebooks (ser√° mostrada via JS) -->
          <div id="ebook-only-notice" class="ebook-only-notice hidden">
            <span class="icon">üìö</span>
            <h3>Compra Digital</h3>
            <p>
              Sua compra cont√©m apenas e-books. N√£o √© necess√°rio endere√ßo de
              entrega.
            </p>
          </div>
          <!-- Se√ß√£o de Endere√ßos -->
          <div class="address-section">
            <div class="address-header">
              <h2>Endere√ßo de Entrega</h2>
              <button
                id="btn-novo-endereco"
                class="btn-add-address"
                type="button"
              >
                + Adicionar Endere√ßo
              </button>
            </div>

            <!-- Lista de endere√ßos existentes -->
            <div id="enderecos-lista" class="address-list">
              <!-- Endere√ßos ser√£o carregados aqui -->
            </div>

            <!-- Estado vazio (quando n√£o h√° endere√ßos) -->
            <div id="enderecos-vazio" class="empty-addresses hidden">
              <div class="empty-state">
                <svg
                  width="64"
                  height="64"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1"
                >
                  <path
                    d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
                  ></path>
                  <polyline points="9,22 9,12 15,12 15,22"></polyline>
                </svg>
                <h3>Nenhum endere√ßo cadastrado</h3>
                <p>
                  Adicione um endere√ßo de entrega para continuar com seu pedido.
                </p>
                <button id="btn-primeiro-endereco" class="btn btn-primary">
                  Adicionar Endere√ßo
                </button>
              </div>
            </div>
          </div>

          <!-- Formul√°rio de endere√ßo (inicialmente oculto) -->
          <div id="formulario-endereco" class="address-form-container hidden">
            <div class="form-header">
              <h3 id="form-titulo">Adicionar Novo Endere√ßo</h3>
              <button
                id="btn-cancelar-endereco"
                class="btn-cancel"
                type="button"
              >
                ‚úï
              </button>
            </div>

            <form id="checkout-address-form">
              <input type="hidden" id="endereco-id" />

              <div class="form-row">
                <div class="form-group">
                  <label for="endereco">Endere√ßo *</label>
                  <input
                    type="text"
                    id="endereco"
                    name="endereco"
                    class="input-finalizacao"
                    placeholder="Rua, Avenida, etc."
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="numero">N√∫mero *</label>
                  <input
                    type="text"
                    id="numero"
                    name="numero"
                    class="input-finalizacao"
                    placeholder="123"
                    required
                  />
                </div>
              </div>

              <div class="form-group">
                <label for="complemento">Complemento</label>
                <input
                  type="text"
                  id="complemento"
                  name="complemento"
                  class="input-finalizacao"
                  placeholder="Apto, Bloco, etc. (opcional)"
                />
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="bairro">Bairro *</label>
                  <input
                    type="text"
                    id="bairro"
                    name="bairro"
                    class="input-finalizacao"
                    placeholder="Nome do bairro"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="cidade">Cidade *</label>
                  <input
                    type="text"
                    id="cidade"
                    name="cidade"
                    class="input-finalizacao"
                    placeholder="Nome da cidade"
                    required
                  />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="estado">Estado *</label>
                  <input
                    type="text"
                    id="estado"
                    name="estado"
                    maxlength="2"
                    class="input-finalizacao"
                    placeholder="SP"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="cep">CEP</label>
                  <input
                    type="text"
                    id="cep"
                    name="cep"
                    maxlength="9"
                    class="input-finalizacao"
                    placeholder="00000-000"
                  />
                </div>
              </div>

              <div class="form-checkbox">
                <input type="checkbox" id="is_principal" name="is_principal" />
                <label for="is_principal"
                  >Definir como endere√ßo principal</label
                >
              </div>

              <div class="form-actions">
                <button
                  type="button"
                  id="btn-cancelar-form"
                  class="btn btn-secondary"
                >
                  Cancelar
                </button>
                <button
                  type="submit"
                  id="btn-salvar-endereco"
                  class="btn btn-primary btn-loading"
                >
                  Salvar Endere√ßo
                </button>
              </div>
            </form>
          </div>

          <!-- Forma de Pagamento -->
          <div class="payment-section">
            <h2>Forma de Pagamento</h2>
            <form id="checkout-payment-form">
              <div class="payment-options">
                <div class="payment-option">
                  <input
                    type="radio"
                    id="cartao"
                    name="payment"
                    value="cartao"
                    checked
                  />
                  <label for="cartao">Cart√£o de Cr√©dito</label>
                </div>
                <div class="payment-option">
                  <input
                    type="radio"
                    id="boleto"
                    name="payment"
                    value="boleto"
                  />
                  <label for="boleto">Boleto Banc√°rio</label>
                </div>
                <div class="payment-option">
                  <input type="radio" id="pix" name="payment" value="pix" />
                  <label for="pix">PIX</label>
                </div>
              </div>

              <!-- Container fixo para todos os formul√°rios -->
              <div class="payment-forms-container">
                <div id="cartao-form" class="payment-form active">
                  <div class="form-group">
                    <label for="card-number">N√∫mero do Cart√£o</label>
                    <input
                      type="text"
                      id="card-number"
                      maxlength="19"
                      class="input-finalizacao"
                      required
                    />
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="card-name">Nome no Cart√£o</label>
                      <input
                        type="text"
                        id="card-name"
                        class="input-finalizacao"
                        required
                      />
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="card-expiry">Validade (MM/AA)</label>
                      <input
                        type="text"
                        id="card-expiry"
                        maxlength="5"
                        class="input-finalizacao"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="card-cvv">CVV</label>
                      <input
                        type="text"
                        id="card-cvv"
                        maxlength="3"
                        class="input-finalizacao"
                        required
                      />
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="parcelas">Parcelas</label>
                    <select id="parcelas" class="input-finalizacao"></select>
                  </div>
                </div>

                <div id="boleto-form" class="payment-form">
                  <p>
                    Um boleto ser√° gerado ap√≥s a confirma√ß√£o do pedido e enviado
                    para seu e-mail.
                  </p>
                </div>

                <div id="pix-form" class="payment-form">
                  <p>Escaneie o QR Code abaixo para pagar:</p>
                  <img
                    src="https://user-images.githubusercontent.com/25679721/114888298-b9ea0680-9e26-11eb-8b90-cd2a61a4cfbf.png"
                    alt="QR Code PIX"
                  />
                </div>
              </div>
            </form>
          </div>
        </section>

        <section class="order-summary">
          <h2>Resumo do Pedido</h2>
          <div id="order-items" class="order-items"></div>
          <div class="order-totals">
            <p>
              Produtos: <span>R$ <span id="subtotal">0,00</span></span>
            </p>
            <p>
              Frete: <span><span id="frete">0,00</span></span>
            </p>
            <p class="total">
              Total: <span>R$ <span id="total">0,00</span></span>
            </p>
          </div>
          <button
            id="confirm-order-final"
            class="btn-confirmar btn-loading"
            disabled
          >
            Confirmar Pedido
          </button>
          <a href="carrinho.html" class="voltar-carrinho">Voltar ao Carrinho</a>
        </section>
      </div>
    </main>

    <footer>¬© 2025 - Todos os direitos reservados.</footer>

    <script src="../public/js/navigation.js"></script>
    <script type="module" src="../public/js/pages/search-books.js"></script>
    <script type="module" src="../public/js/status.js"></script>
    <script type="module" src="../public/js/profile-menu.js"></script>
    <script type="module" src="../public/js/pages/pedido.js"></script>
  </body>
</html>
